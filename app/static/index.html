<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>AI Integration Demo</title>
    <style>
pre {
    white-space: pre-wrap;   /* δείχνει τα \n σωστά */
    background: #f2f2f2;     /* ανοιχτό γκρι background */
    padding: 10px;
    border-radius: 6px;
    font-size: 15px;
    color: black;            /* μαύρο κείμενο */
}
textarea, input {
    font-size: 15px;
}
button {
    padding: 6px 12px;
    font-size: 15px;
    cursor: pointer;
}
</style>

</head>
<body>
<h2>AI Integration Demo</h2>

<!-- Chat Section -->
<h3>Chat</h3>
<textarea id="prompt" rows="5" cols="60" placeholder="Γράψε την ερώτησή σου εδώ..."></textarea><br>
<button onclick="sendChat()">Send</button>
<pre id="chatResult"></pre>

<hr>

<!-- Upload Section -->
<h3>Upload Document</h3>
<input type="file" id="fileInput">
<button onclick="uploadDoc()">Upload</button>
<pre id="uploadResult"></pre>

<hr>

<!-- RAG Query Section -->
<h3>Ask with RAG</h3>
<input id="queryText" type="text" size="50" placeholder="Ρώτα κάτι που σχετίζεται με το αρχείο...">
<button onclick="ragQuery()">Ask</button>
<pre id="queryResult"></pre>

<script>
async function sendChat() {
    const text = document.getElementById("prompt").value;

    const res = await fetch('/chat', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({prompt: text})
    });

    const json = await res.json();
    document.getElementById("chatResult").innerText = JSON.stringify(json, null, 2);
}

async function uploadDoc() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) { alert("Επίλεξε αρχείο πρώτα!"); return; }

    const formData = new FormData();
    formData.append("file", file);

    const res = await fetch('/upload', {
        method: 'POST',
        body: formData
    });

    const json = await res.json();
    document.getElementById("uploadResult").innerText = JSON.stringify(json, null, 2);
}

async function ragQuery() {
    const q = document.getElementById("queryText").value;

    const res = await fetch('/query', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({query: q, top_k: 3})
    });

    const json = await res.json();
    document.getElementById("queryResult").innerText = JSON.stringify(json, null, 2);
}
</script>

</body>
</html>
